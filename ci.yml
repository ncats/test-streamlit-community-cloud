# DO NOT MODIFY OR DELETE THIS FILE.
#
# ANY CHANGES MAY RESULT IN SERIOUS DAMAGE
# TO THE TECHNICAL INFRASTRUCTURE AND LOSS OF DATA!
#
# ACCESS TO OR USE OF PALANTIR FOUNDRY IS SUBJECT
# TO PALANTIRâ€™S TECHNICAL SPECIFICATIONS AVAILABLE
# IN THE DOCUMENTATION. THIS WARNING CONSTITUTES AN
# ADDITION TO THOSE TECHNICAL SPECIFICATIONS AND
# NON-COMPLIANCE MAY CONSTITUTE A VIOLATION OF
# THE FOUNDRY LICENSE AGREEMENT.

env:
  FOUNDRY_ARTIFACTS_API:
    uri-role: foundry-artifacts-api
  FOUNDRY_CONTAINER_SERVICE_API:
    uri-role: foundry-container-service-api
  STEMMA_API:
    uri-role: stemma-api


required-job-token-capabilities:
  - code-workspaces


jobs:
  publish-dashboards:
    steps:
      - |
        # GIT_VERSION will have the format "70-g673601c"
        export GIT_VERSION=$(git rev-list --count HEAD)-g$(git show -s --abbrev-commit --abbrev=7 --pretty=format:%h)
        export SSL_CERT_FILE=/etc/ssl/rubix-ca/external-ca.pem
        python .publish-dashboards.py
